# Stock CNN è®­ç»ƒæŠ¥å‘Š

## 1. å®éªŒæ¦‚è¿°

æœ¬å®éªŒåŸºäºè®ºæ–‡ **(Re-)Imag(in)ing Price Trends** çš„æ–¹æ³•ï¼Œä½¿ç”¨å·ç§¯ç¥ç»ç½‘ç»œå¯¹è‚¡ç¥¨ä»·æ ¼å›¾åƒè¿›è¡Œåˆ†ç±»ï¼Œé¢„æµ‹æœªæ¥20å¤©çš„æ”¶ç›Šæ–¹å‘ã€‚æˆ‘ä»¬è®­ç»ƒå¹¶æ¯”è¾ƒäº†ä¸‰ç§ä¸åŒæ¶æ„çš„æ¨¡å‹ï¼šBaseline CNNã€Baseline Large CNN å’Œ Vision Transformer (ViT)ã€‚

---

## 2. å®éªŒç¯å¢ƒ

### 2.1 ç¡¬ä»¶é…ç½®
| é…ç½®é¡¹ | è§„æ ¼ |
|--------|------|
| GPU | NVIDIA GPU Ã— 2 (ä½¿ç”¨ DataParallel) |
| GPU ç¼–å· | cuda:6, cuda:7 |
| å¹¶è¡Œæ–¹å¼ | nn.DataParallel |

### 2.2 è½¯ä»¶ç¯å¢ƒ
| è½¯ä»¶ | ç‰ˆæœ¬ |
|------|------|
| Python | 3.10 |
| PyTorch | 2.6.0 |
| CUDA | 12.6 |

---

## 3. æ•°æ®é›†

### 3.1 è®­ç»ƒæ•°æ®
| é¡¹ç›® | è¯´æ˜ |
|------|------|
| æ—¶é—´èŒƒå›´ | 1993å¹´ - 2000å¹´ |
| æ ·æœ¬æ•°é‡ | 793,019 |
| å›¾åƒå°ºå¯¸ | 64 Ã— 60 (é«˜ Ã— å®½) |
| å›¾åƒç±»å‹ | 20æ—¥Kçº¿å›¾ (å«æˆäº¤é‡æŸ±) |
| æ ‡ç­¾ | äºŒåˆ†ç±» (æœªæ¥20æ—¥æ”¶ç›Š > 0) |

### 3.2 æ•°æ®åˆ’åˆ†
| åˆ’åˆ†æ–¹å¼ | æ¯”ä¾‹ | æ ·æœ¬æ•° |
|----------|------|--------|
| è®­ç»ƒé›† | 70% | 555,113 |
| éªŒè¯é›† | 30% | 237,906 |
| åˆ’åˆ†æ–¹æ³• | æ—¶åºåˆ’åˆ† (ééšæœº) | - |

---

## 4. æ¨¡å‹æ¶æ„

### 4.1 Baseline CNN
```
ç»“æ„: Conv2d â†’ BatchNorm â†’ LeakyReLU â†’ MaxPool (Ã—3) â†’ FC â†’ Softmax
é€šé“æ•°: 1 â†’ 64 â†’ 128 â†’ 256 â†’ 2
å·ç§¯æ ¸: 5Ã—3
å‚æ•°é‡: 708,866 (0.71M)
FLOPs: 72.44G
```

### 4.2 Baseline Large CNN
```
ç»“æ„: Conv2d â†’ BatchNorm â†’ LeakyReLU â†’ MaxPool (Ã—3) â†’ FC â†’ Softmax
é€šé“æ•°: 1 â†’ 96 â†’ 192 â†’ 384 â†’ 2
å·ç§¯æ ¸: 5Ã—3
å‚æ•°é‡: 10,233,602 (10.23M)
```

### 4.3 Vision Transformer (ViT)
```
ç»“æ„: PatchEmbed â†’ Transformer Encoder (Ã—6) â†’ MLP Head
Patch å¤§å°: 8Ã—8
åµŒå…¥ç»´åº¦: 256
æ³¨æ„åŠ›å¤´æ•°: 8
å‚æ•°é‡: 10,821,314 (10.82M)
```

---

## 5. è®­ç»ƒé…ç½®

### 5.1 è¶…å‚æ•°è®¾ç½®
| è¶…å‚æ•° | å€¼ |
|--------|-----|
| æ‰¹å¤§å° (å•GPU) | 256 |
| æœ‰æ•ˆæ‰¹å¤§å° | 512 (256 Ã— 2 GPUs) |
| ä¼˜åŒ–å™¨ | Adam |
| å­¦ä¹ ç‡ | 1e-5 |
| æŸå¤±å‡½æ•° | CrossEntropyLoss |
| æœ€å¤§è®­ç»ƒè½®æ•° | 100 |
| æ—©åœè€å¿ƒå€¼ | 5 epochs |
| æƒé‡åˆå§‹åŒ– | Xavier Uniform |

### 5.2 è®­ç»ƒæ­¥æ•°
| é¡¹ç›® | å€¼ |
|------|-----|
| æ¯ä¸ª Epoch è®­ç»ƒæ­¥æ•° | 2,169 steps |
| æ¯ä¸ª Epoch éªŒè¯æ­¥æ•° | 930 steps |
| è®­ç»ƒé€Ÿåº¦ | ~50-60 it/s |

---

## 6. è®­ç»ƒç»“æœå¯¹æ¯”

### 6.1 æœ€ä½³æ¨¡å‹æ€§èƒ½
| æ¨¡å‹ | å‚æ•°é‡ | æœ€ä½³ Epoch | æœ€ä½³éªŒè¯æŸå¤± | æ€»è®­ç»ƒè½®æ•° |
|------|--------|------------|--------------|------------|
| **Baseline** | 0.71M | 18 | 0.6871 | 29 |
| **Baseline Large** | 10.23M | 26 | **0.6864** | 37 |
| **ViT** | 10.82M | 7 | 0.6917 | 18 |

### 6.2 è®­ç»ƒè¿‡ç¨‹è®°å½• (Baseline æ¨¡å‹ç¤ºä¾‹)

| Epoch | è®­ç»ƒæŸå¤± | éªŒè¯æŸå¤± | è®­ç»ƒæ—¶é—´ |
|-------|----------|----------|----------|
| 0 | 0.9300 | ~0.72 | ~36s |
| 1 | 0.7900 | ~0.71 | ~45s |
| 2 | 0.7540 | ~0.70 | ~34s |
| 3 | 0.7350 | ~0.70 | ~35s |
| 4 | 0.7220 | ~0.69 | ~38s |
| 5 | 0.7140 | ~0.69 | ~35s |
| ... | ... | ... | ... |
| 18 | ~0.689 | 0.6871 | ~35s |

### 6.3 æ”¶æ•›ç‰¹æ€§
| æ¨¡å‹ | æ”¶æ•›é€Ÿåº¦ | æœ€ç»ˆæ€§èƒ½ | è®­ç»ƒç¨³å®šæ€§ |
|------|----------|----------|------------|
| Baseline | ä¸­ç­‰ | è‰¯å¥½ | â­â­â­â­ |
| Baseline Large | è¾ƒæ…¢ | æœ€ä½³ | â­â­â­â­ |
| ViT | è¾ƒå¿« | è¾ƒå·® | â­â­â­ |

---

## 7. è®­ç»ƒæ•ˆç‡åˆ†æ

### 7.1 æ—¶é—´å¼€é”€
| æ¨¡å‹ | å• Epoch æ—¶é—´ | æ€»è®­ç»ƒæ—¶é—´ | æ¨ç†é€Ÿåº¦ |
|------|---------------|------------|----------|
| Baseline | ~50s | ~25min | å¿« |
| Baseline Large | ~80s | ~50min | ä¸­ |
| ViT | ~120s | ~36min | æ…¢ |

### 7.2 GPU åˆ©ç”¨ç‡
- ä½¿ç”¨ DataParallel åœ¨ 2 å— GPU ä¸Šå¹¶è¡Œè®­ç»ƒ
- æœ‰æ•ˆæ‰¹å¤§å° = 256 Ã— 2 = 512
- GPU æ˜¾å­˜åˆ©ç”¨ç‡: ~70-80%

---

## 8. æ¨¡å‹ä¿å­˜

### 8.1 ä¿å­˜è·¯å¾„
```
pt/
â”œâ”€â”€ baseline/
â”‚   â”œâ”€â”€ best.pt                    # æœ€ä½³æ¨¡å‹
â”‚   â””â”€â”€ baseline_epoch_X_train_X_val_X.pt  # å„ epoch æ£€æŸ¥ç‚¹
â”œâ”€â”€ baseline_large/
â”‚   â”œâ”€â”€ best.pt
â”‚   â””â”€â”€ baseline_large_epoch_X_train_X_val_X.pt
â””â”€â”€ vit/
    â”œâ”€â”€ best.pt
    â””â”€â”€ vit_epoch_X_train_X_val_X.pt
```

### 8.2 TensorBoard æ—¥å¿—
```
runs/
â””â”€â”€ YYYYMMDD_HH:MM:SS/
    â”œâ”€â”€ Loss/train_step    # æ¯100æ­¥è®°å½•
    â”œâ”€â”€ Loss/train_epoch   # æ¯epochè®°å½•
    â””â”€â”€ Loss/val_epoch     # æ¯epochè®°å½•
```

---

## 9. å…³é”®å‘ç°

### 9.1 æ¨¡å‹å¤æ‚åº¦ vs æ€§èƒ½
- ğŸ† **Baseline Large è·å¾—æœ€ä½éªŒè¯æŸå¤±** (0.6864)
- ğŸ“Š ä½† Baseline æ¨¡å‹çš„æ€§ä»·æ¯”æœ€é«˜ (å‚æ•°é‡ä»… 0.71M)
- âš ï¸ ViT åœ¨æ­¤ä»»åŠ¡ä¸Šè¡¨ç°ä¸ä½³ï¼Œå¯èƒ½ä¸é€‚åˆå°å°ºå¯¸å›¾åƒåˆ†ç±»

### 9.2 è®­ç»ƒå»ºè®®
1. **æ¨èä½¿ç”¨ Baseline æ¨¡å‹**: å‚æ•°å°‘ã€è®­ç»ƒå¿«ã€æ€§èƒ½ç¨³å®š
2. **æ—©åœæœºåˆ¶æœ‰æ•ˆ**: é˜²æ­¢è¿‡æ‹Ÿåˆï¼ŒèŠ‚çœè®­ç»ƒæ—¶é—´
3. **å­¦ä¹ ç‡ 1e-5 é€‚ä¸­**: æ”¶æ•›ç¨³å®šï¼Œä¸ä¼šéœ‡è¡

---

## 10. å¤ç°æŒ‡å—

### 10.1 ç¯å¢ƒå‡†å¤‡
```bash
conda create -n Math5470 python=3.10
conda activate Math5470
pip install torch==2.6.0 torchvision==0.21.0 --index-url https://download.pytorch.org/whl/cu126
pip install -r requirements.txt
```

### 10.2 å¼€å§‹è®­ç»ƒ
```bash
cd notebooks
jupyter notebook train.ipynb
```

### 10.3 ç›‘æ§è®­ç»ƒ
```bash
tensorboard --logdir=runs
```

---

## 11. è¾“å‡ºæ–‡ä»¶è¯´æ˜

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `pt/*/best.pt` | å„æ¨¡å‹æœ€ä½³æ£€æŸ¥ç‚¹ |
| `pic/training_comparison.png` | è®­ç»ƒæ›²çº¿å¯¹æ¯”å›¾ |
| `runs/` | TensorBoard æ—¥å¿— |
| `*.onnx` | ONNX æ ¼å¼æ¨¡å‹ (å¯é€‰å¯¼å‡º) |

---

*æŠ¥å‘Šç”Ÿæˆæ—¶é—´: 2025å¹´12æœˆ*
